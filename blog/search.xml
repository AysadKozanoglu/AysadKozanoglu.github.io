<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>cryptsetup LUKS2 Creating encrypted virtual Disk Image and mount it</title>
      <link href="/blog/cryptsetup/luks/encryption/virtual/disk/howto/"/>
      <url>/blog/cryptsetup/luks/encryption/virtual/disk/howto/</url>
      
        <content type="html"><![CDATA[<pre class="mermaid" style="background: none">flowchart LR   id1[/Create virtual Disk/]-->   id2[/LUKS format/]-->   id3[/set passphrase/]-->   id4[/format with ext4 /]-->   id5[/create mount ṕoint/]-->   id6[/detach mount /]-->   id7[/close LUKS /]</pre><h2 id="overview"><a href="#overview" class="headerlink" title="overview"></a>overview</h2><ul><li>creating virtual disk with dd </li><li>format and encrypt virtaul disk with cryptsetup <ul><li>setpassphrase</li></ul></li><li>opening encrypted virtual disk with cryptsetup<ul><li>format virtual disk with ext4 mkfs</li><li>create mountpoint with mkdir</li><li>mount LUKS opened disk to mointpoint</li><li>detach mount</li><li>close LUKS</li></ul></li></ul><h2 id="Creating-virtual-Disk-file"><a href="#Creating-virtual-Disk-file" class="headerlink" title="Creating virtual Disk file"></a>Creating virtual Disk file</h2><p>virtual disk filename:<br>crypted-disk-luks.img</p><p>size:<br>100MB</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="attribute">if</span>=/dev/zero <span class="attribute">of</span>=crypted-disk-luks.img  <span class="attribute">bs</span>=100M <span class="attribute">count</span>=0 <span class="attribute">seek</span>=1</span><br></pre></td></tr></table></figure><blockquote><p>info: with <em>fdisk -l crypted-disk-luks.img</em> you can check virtual disk size</p></blockquote><h2 id="Disk-Encryption-preparation"><a href="#Disk-Encryption-preparation" class="headerlink" title="Disk Encryption preparation"></a>Disk Encryption preparation</h2><h3 id="format-and-encrypt-virtual-disk"><a href="#format-and-encrypt-virtual-disk" class="headerlink" title="format and encrypt virtual disk"></a>format and encrypt virtual disk</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cryptsetup -<span class="selector-tag">q</span> -y  luksFormat crypted-disk-luks<span class="selector-class">.img</span></span><br></pre></td></tr></table></figure><blockquote><p>info: you will be asked for passphrase to encrypt&#x2F;decrypt disk </p></blockquote><h3 id="open-LUKS-encrypted-virtual-disk"><a href="#open-LUKS-encrypted-virtual-disk" class="headerlink" title="open LUKS encrypted virtual disk"></a>open LUKS encrypted virtual disk</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">sudo</span> cryptsetup luksOpen /<span class="class"><span class="keyword">data</span>/crypted/crypted-disk-luks.img virtualDiskMapper</span></span><br></pre></td></tr></table></figure><blockquote><p>info: virtualDiskMapper is the pointname under &#x2F;dev&#x2F;mapper&#x2F;virtalDiskMapper</p></blockquote><h2 id="check-LUKS-opened-virual-Disk-on-dev-mapper"><a href="#check-LUKS-opened-virual-Disk-on-dev-mapper" class="headerlink" title="check LUKS opened virual Disk on &#x2F;dev&#x2F;mapper"></a>check LUKS opened virual Disk on &#x2F;dev&#x2F;mapper</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo fdisk -l <span class="regexp">/dev/m</span>apper/virtualDiskMapper</span><br></pre></td></tr></table></figure><blockquote><p>info: you should see size of disk little less than 100MB (it is ok)</p></blockquote><h3 id="format-inside-opened-LUKS-the-virtual-Disk-with-your-prefered-file-system"><a href="#format-inside-opened-LUKS-the-virtual-Disk-with-your-prefered-file-system" class="headerlink" title="format inside opened LUKS the virtual Disk with your prefered file system"></a>format inside opened LUKS the virtual Disk with your prefered file system</h3><p>in this case: ext4</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkfs.ext4 <span class="regexp">/dev/m</span>apper/virtualDiskMapper</span><br></pre></td></tr></table></figure><blockquote><p>info: this format has no  effect to encryption, so do it</p></blockquote><h2 id="Mount-LUKS-encrypted-virtual-disk"><a href="#Mount-LUKS-encrypted-virtual-disk" class="headerlink" title="Mount LUKS encrypted virtual disk"></a>Mount LUKS encrypted virtual disk</h2><p>above we opened LUKS enrypted virtual already, in this point you dont need to open, because it is opened with passphrase already.</p><blockquote><p>sudo cryptsetup luksOpen &#x2F;data&#x2F;crypted&#x2F;crypted-disk-luks.img virtualDiskMapper</p></blockquote><h3 id="create-mountpoint-for-LUKS-virtual-disk"><a href="#create-mountpoint-for-LUKS-virtual-disk" class="headerlink" title="create mountpoint for LUKS virtual disk"></a>create mountpoint for LUKS virtual disk</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /mnt/LUKSDISK</span><br></pre></td></tr></table></figure><blockquote><p>info: this mointpoint you need to create only one time</p></blockquote><h3 id="mount-LUKS-virtual-disk-to-mointpoint"><a href="#mount-LUKS-virtual-disk-to-mointpoint" class="headerlink" title="mount LUKS virtual disk to mointpoint"></a>mount LUKS virtual disk to mointpoint</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mount <span class="regexp">/dev/m</span>apper<span class="regexp">/virtualDiskMapper /m</span>nt/LUKSDISK</span><br></pre></td></tr></table></figure><h2 id="closing-LUKS-opened-virtual-disk"><a href="#closing-LUKS-opened-virtual-disk" class="headerlink" title="closing LUKS opened virtual disk"></a>closing LUKS opened virtual disk</h2><p>actually our enrypted disk is mounted on moinpoint.<br>so first detach mountpoint</p><h3 id="detach-moinpoint"><a href="#detach-moinpoint" class="headerlink" title="detach moinpoint"></a>detach moinpoint</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo umount <span class="regexp">/mnt/</span>LUKSDISK</span><br></pre></td></tr></table></figure><h3 id="close-LUKS-virtual-Disk"><a href="#close-LUKS-virtual-Disk" class="headerlink" title="close LUKS virtual Disk"></a>close LUKS virtual Disk</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo cryptsetup luksClose virtualDiskMapper</span></span><br></pre></td></tr></table></figure><blockquote><p>info: this commad will detach dev mapped virtualDiskMapper also</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> cryptsetup </category>
          
          <category> luks </category>
          
          <category> encryption </category>
          
          <category> virtual </category>
          
          <category> disk </category>
          
      </categories>
      
      
        <tags>
            
            <tag> encryption </tag>
            
            <tag> decryption </tag>
            
            <tag> mount </tag>
            
            <tag> cryptsetup </tag>
            
            <tag> LUKS </tag>
            
            <tag> virtual Disk </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openssl aes-256 text encryption / decryption interactive mode</title>
      <link href="/blog/encrypt/decrypt/aes-256/openssl/howto/"/>
      <url>/blog/encrypt/decrypt/aes-256/openssl/howto/</url>
      
        <content type="html"><![CDATA[<pre class="mermaid" style="background: none">journey    title openssl aes-256  encryption interactive mode    section on Console      openssl : 5: use case      aes-256-cbc: 5: use case      enter text: 5: use case      enter secret: 5: use case      hash: 5: use case</pre><h2 id="openssl-AES-256-interactive-mode-encryption-and-decryption"><a href="#openssl-AES-256-interactive-mode-encryption-and-decryption" class="headerlink" title="openssl AES-256 interactive mode encryption and decryption"></a>openssl AES-256 interactive mode encryption and decryption</h2><h2 id="aes-256-encryption-interactive-mode-with-openssl"><a href="#aes-256-encryption-interactive-mode-with-openssl" class="headerlink" title="aes-256 encryption interactive mode with openssl"></a>aes-256 encryption interactive mode with openssl</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> -v PASS</span><br><span class="line"><span class="built_in">unset</span> -v STRING</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n\n Text to encrypt:&quot;</span>; <span class="built_in">read</span> STRING;</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n\nPassword: &quot;</span>; <span class="built_in">read</span> -s PASS;</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n&quot;</span>; <span class="built_in">echo</span> Encrypted:;</span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;<span class="variable">$STRING</span>&quot;</span> | openssl enc -e -<span class="built_in">base64</span> -A -a -pbkdf2 -aes-256-cbc -pass pass:<span class="string">&quot;<span class="variable">$PASS</span>&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n\n&quot;</span></span><br></pre></td></tr></table></figure><h2 id="aes-256-decryption-interactive-mode-with-openssl"><a href="#aes-256-decryption-interactive-mode-with-openssl" class="headerlink" title="aes-256 decryption interactive mode with openssl"></a>aes-256 decryption interactive mode with openssl</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> -v PASS</span><br><span class="line"><span class="built_in">unset</span> -v STRING</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n\n Encrypted Hash:&quot;</span>; <span class="built_in">read</span> STRING; </span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n\n Password: &quot;</span>; <span class="built_in">read</span> -s PASS;</span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n\nDecrypted:&quot;</span>; </span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;<span class="variable">$STRING</span>&quot;</span> | openssl enc -d -<span class="built_in">base64</span> -A -aes-256-cbc -a -pbkdf2  -pass pass:<span class="string">&quot;<span class="variable">$PASS</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\n\n&quot;</span></span><br></pre></td></tr></table></figure><p>demo:</p><script type="text/javascript" src="https://asciinema.org/a/GyrKDC6Ep3rYhEhCTXu0F57UE.js" id="asciicast-GyrKDC6Ep3rYhEhCTXu0F57UE" async></script><pre class="mermaid" style="background: none">mindmap  root(console)    enter string      enter password        openssl          aes-256 encryption            output aes-256 hash          aes-256 decryption             output plain text string</pre>]]></content>
      
      
      <categories>
          
          <category> encrypt </category>
          
          <category> decrypt </category>
          
          <category> aes-256 </category>
          
          <category> openssl </category>
          
      </categories>
      
      
        <tags>
            
            <tag> aes256 </tag>
            
            <tag> openssl </tag>
            
            <tag> aes-256 </tag>
            
            <tag> crypt </tag>
            
            <tag> decrypt </tag>
            
            <tag> interactive </tag>
            
            <tag> console </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AES256 encryption and decryption file(s) with openssl</title>
      <link href="/blog/encryption/openssl/aes256/howto/"/>
      <url>/blog/encryption/openssl/aes256/howto/</url>
      
        <content type="html"><![CDATA[<pre class="mermaid" style="background: none">journey    title openssl aes-256 file encryption    section on Console      openssl : 3: use case      aes-256-cbc: 4: use case      file: 5: use case      secret: 6: use case</pre><h2 id="AES256-file-encryption"><a href="#AES256-file-encryption" class="headerlink" title="AES256 file encryption"></a>AES256 file encryption</h2><h3 id="encrypt-file-secret-txt-with-openssl"><a href="#encrypt-file-secret-txt-with-openssl" class="headerlink" title="encrypt file secret.txt with openssl"></a>encrypt file secret.txt with openssl</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl aes-<span class="number">256</span>-cbc -<span class="selector-tag">a</span> -salt -pbkdf2 -<span class="keyword">in</span> secrets<span class="selector-class">.txt</span> -out secrets<span class="selector-class">.txt</span>.enc</span><br></pre></td></tr></table></figure><blockquote><p>info: give your password double to protect encryption </p></blockquote><pre class="mermaid" style="background: none">journey    title openssl aes-256 file decryption    section on Console      openssl : 3: use case      aes-256-cbc: 4: use case      encrypted file: 5: use case      secret: 6: use case</pre><h3 id="decrypt-file-secret-txt-enc-openssl"><a href="#decrypt-file-secret-txt-enc-openssl" class="headerlink" title="decrypt file secret.txt.enc openssl"></a>decrypt file secret.txt.enc openssl</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl aes-<span class="number">256</span>-cbc -d -<span class="selector-tag">a</span> -pbkdf2 -<span class="keyword">in</span> secrets<span class="selector-class">.txt</span><span class="selector-class">.enc</span> -out secrets.txt</span><br></pre></td></tr></table></figure><blockquote><p>info: you will be ask for your given protected given password </p></blockquote><p>you can also encrypt tar.gz files, so if you have multiple files to encrypt than compress it with zip , bzip or  tar.gz and than you can encrypt it </p><pre class="mermaid" style="background: none">mindmap  root((openssl))    algorithm      aes-256-cbc        file          encryption            protection              your password          decryption            proctection              your password</pre><p>thanks for reading</p><p>–<br>Aysad Kozanoglu</p>]]></content>
      
      
      <categories>
          
          <category> encryption </category>
          
          <category> openssl </category>
          
          <category> aes256 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> aes256 </tag>
            
            <tag> encryption </tag>
            
            <tag> decryption </tag>
            
            <tag> openssl </tag>
            
            <tag> files </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LVM raid1 recovery: mount disk on another linux system debian buster</title>
      <link href="/blog/lvm/raid1/disk/mount/recovery/howto/"/>
      <url>/blog/lvm/raid1/disk/mount/recovery/howto/</url>
      
        <content type="html"><![CDATA[<pre class="mermaid" style="background: none">flowchart LRdisk1---|LVM raid1|disk2</pre><h2 id="scenario"><a href="#scenario" class="headerlink" title="scenario"></a>scenario</h2><p>in my showcase, i was using two ssd 2TB disks in LVM in raid1 mode.<br>My system was debian buster (10).</p><p>My Mainboard was crashed and i was not able to boot up my system. My OS  was installed on  seperatly 240GB ssd.</p><p>So my soft raid1 with LVM for the 2 disk with 2TB ssd, i was not able to get my data from there.</p><ul><li>240gb OS # only OS</li><li>2TB LVM Raid1 disk1 # data</li><li>2TB LVM Raid1 disk2 # data</li></ul><p>Here is my solution for recovery data from LVM raid1 from one part of disk from lvm raid1</p><h3 id="remove-disk-from-damaged-hardware"><a href="#remove-disk-from-damaged-hardware" class="headerlink" title="remove disk from  damaged hardware"></a>remove disk from  damaged hardware</h3><p>remove the one part of the ssd disk to connect with usb ssd adapter (sabrent) to another system. in my case i  working with debian buster (10)</p><h3 id="connect-disk-to-another-working-system"><a href="#connect-disk-to-another-working-system" class="headerlink" title="connect disk to another working system"></a>connect disk to another working system</h3><p>connect the disk with usb ssd adapter to your another working machine. in my case debian buster (10)</p><h2 id="get-info-from-connected-ssd-with-usb"><a href="#get-info-from-connected-ssd-with-usb" class="headerlink" title="get info from connected ssd with usb"></a>get info from connected ssd with usb</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">fdisk -l</span></span><br><span class="line"><span class="attribute">pvdisplay</span></span><br><span class="line"><span class="attribute">vgdisplay</span></span><br></pre></td></tr></table></figure><blockquote><p>info: all this commands gives you  output and you would  get  information about disk,  lovume group, partiton volume, VG name, PV name</p></blockquote><p>pvdisplay and vgdisplay output should give you in the first line a WARNING:</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">WARNING: </span>Couldn&#x27;t find device with uuid kGfIXi-i1m2-7pqw-5Aqb-mH2U-Q20f-YMrg1M.</span><br><span class="line"><span class="symbol">WARNING: </span>VG VG01_STORAGE_RAID1 is missing PV kGfIXi-i1m2-7pqw-5Aqb-mH2U-Q20f-YMrg1M (last written to /dev/sdc).</span><br><span class="line"></span><br><span class="line"><span class="code">  --- Physical volume ---</span></span><br><span class="line"><span class="code">  PV Name               [unknown]</span></span><br><span class="line"><span class="code">  VG Name               VG01_STORAGE_RAID1</span></span><br><span class="line"><span class="code">  PV Size               &lt;1,82 TiB / not usable &lt;1,09 MiB</span></span><br><span class="line"><span class="code">  Allocatable           yes (but full)</span></span><br><span class="line"><span class="code">  PE Size               4,00 MiB</span></span><br><span class="line"><span class="code">  Total PE              476932</span></span><br><span class="line"><span class="code">  Free PE               0</span></span><br><span class="line"><span class="code">  Allocated PE          476932</span></span><br><span class="line"><span class="code">  PV UUID               kGfIXi-i1m2-7pqw-5Aqb-mH2U-Q20f-YMrg1M</span></span><br><span class="line"></span><br><span class="line"><span class="code">  --- Physical volume ---</span></span><br><span class="line"><span class="code">  PV Name               /dev/sdc</span></span><br><span class="line"><span class="code">  VG Name               VG01_STORAGE_RAID1</span></span><br><span class="line"><span class="code">  PV Size               &lt;1,82 TiB / not usable &lt;1,09 MiB</span></span><br><span class="line"><span class="code">  Allocatable           yes (but full)</span></span><br><span class="line"><span class="code">  PE Size               4,00 MiB</span></span><br><span class="line"><span class="code">  Total PE              476932</span></span><br><span class="line"><span class="code">  Free PE               0</span></span><br><span class="line"><span class="code">  Allocated PE          476932</span></span><br><span class="line"><span class="code">  PV UUID               O0cX9Z-3YD8-dkFX-qPCA-i6RS-fAGe-Nbplt6</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>info: the is valid and it is ok because the partial disk (second disk) is not foundable </p></blockquote><h2 id="mount-lvm-raid1-partial-disk"><a href="#mount-lvm-raid1-partial-disk" class="headerlink" title="mount lvm raid1 partial disk"></a>mount lvm raid1 partial disk</h2><p>first, scan all connected disk for LVM with lvm tool lvscan</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">lvscan</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>output:</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ACTIVE</span> <span class="string">&#x27;/dev/VG01_STORAGE_RAID1/LV01_STORAGE_RAID1&#x27;</span> [&lt;<span class="number">1</span>,<span class="number">82</span> TiB] inherit</span><br></pre></td></tr></table></figure><blockquote><p>info: in my scenario, i  named my volume group  <em>VG01_STORAGE_RAID1&#x2F;LV01_STORAGE_RAID1</em> . this part of disk is not mountable, until i removed the missing part disk (second disk &gt; raid1) </p></blockquote><h2 id="removing-missing-partial-disk-from-LVM-group"><a href="#removing-missing-partial-disk-from-LVM-group" class="headerlink" title="removing missing partial disk from LVM group"></a>removing missing partial disk from LVM group</h2><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">vgreduce</span> <span class="literal">--</span><span class="comment">removemissing</span> <span class="literal">--</span><span class="comment">force VG01_STORAGE_RAID1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>output:</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Couldn<span class="comment">&#x27;t find device with uuid kGfIXi-i1m2-7pqw-5Aqb-mH2U-Q20f-YMrg1M.</span></span><br><span class="line">Removing <span class="keyword">partial</span> LV LV01_STORAGE_RAID1.</span><br><span class="line">Logical volume <span class="string">&quot;LV01_STORAGE_RAID1&quot;</span> successfully removed</span><br><span class="line">Wrote out consistent volume <span class="keyword">group</span> VG01_STORAGE_RAID1</span><br></pre></td></tr></table></figure><blockquote><p>info: failed&#x2F;bad disk is now successfully removed from LVM group</p></blockquote><h2 id="get-UUID-from-partial-VG-disk"><a href="#get-UUID-from-partial-VG-disk" class="headerlink" title="get UUID from partial VG disk"></a>get UUID from partial VG disk</h2><p>to rename VG volume group we have to get VG UUID first.</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">vgdisplay</span></span><br></pre></td></tr></table></figure><p>output:</p><figure class="highlight irpf90"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">--- Volume group ---</span><br><span class="line">VG <span class="keyword">Name</span>               VG01_STORAGE_RAID1</span><br><span class="line">System ID</span><br><span class="line"><span class="keyword">Format</span>                lvm2</span><br><span class="line">Metadata Areas        <span class="number">1</span></span><br><span class="line">Metadata <span class="keyword">Sequence</span> No  <span class="number">3</span></span><br><span class="line">VG <span class="keyword">Access</span>             read/<span class="built_in">write</span></span><br><span class="line">VG <span class="keyword">Status</span>             resizable</span><br><span class="line"><span class="built_in">MAX</span> LV                <span class="number">0</span></span><br><span class="line">Cur LV                <span class="number">1</span></span><br><span class="line">Open LV               <span class="number">0</span></span><br><span class="line"><span class="built_in">Max</span> PV                <span class="number">0</span></span><br><span class="line">Cur PV                <span class="number">2</span></span><br><span class="line">Act PV                <span class="number">1</span></span><br><span class="line">VG <span class="built_in">Size</span>               &lt;<span class="number">3</span>,<span class="number">64</span> TiB</span><br><span class="line">PE <span class="built_in">Size</span>               <span class="number">4</span>,<span class="number">00</span> MiB</span><br><span class="line">Total PE              <span class="number">953864</span></span><br><span class="line">Alloc PE / <span class="built_in">Size</span>       <span class="number">953864</span> / &lt;<span class="number">3</span>,<span class="number">64</span> TiB</span><br><span class="line"><span class="keyword">Free</span>  PE / <span class="built_in">Size</span>       <span class="number">0</span> / <span class="number">0</span></span><br><span class="line">VG UUID               WNR45t-kuju-bSZq-iF2f-LJoA-ZCdb-G2uDkl</span><br></pre></td></tr></table></figure><blockquote><p>info: VG UUID is WNR45t-kuju-bSZq-iF2f-LJoA-ZCdb-G2uDkl</p></blockquote><h2 id="rename-VG-volume-group-name"><a href="#rename-VG-volume-group-name" class="headerlink" title="rename VG volume group name"></a>rename VG volume group name</h2><p>to mount as single disk we have to rename the LVM VG name first</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#vgrename &lt;UUID&gt;  NEW_NAME</span></span><br><span class="line">vgrename WNR45t-kuju-bSZq-iF2f-LJoA-ZCdb-G2uDkl NEW_VG01_STORAGE_RAID1</span><br><span class="line">vgchange -ay</span><br><span class="line">lvscan</span><br><span class="line"></span><br><span class="line">$<span class="meta">#: ACTIVE <span class="string">&#x27;/dev/NEW_VG01_STORAGE_RAID1/LV01_STORAGE_RAID1&#x27;</span> [&lt;1,82 TiB] inherit</span></span><br></pre></td></tr></table></figure><blockquote><p>info: now VG name is renamed to NEW_VG01_STORAGE_RAID1</p></blockquote><h2 id="mount-LVM-to-mountpoint"><a href="#mount-LVM-to-mountpoint" class="headerlink" title="mount LVM to mountpoint"></a>mount LVM to mountpoint</h2><h3 id="enable-dm-mod-in-kernel"><a href="#enable-dm-mod-in-kernel" class="headerlink" title="enable dm-mod in kernel"></a>enable dm-mod in kernel</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modprobe dm-<span class="keyword">mod</span></span><br></pre></td></tr></table></figure><h3 id="create-mountpoint"><a href="#create-mountpoint" class="headerlink" title="create mountpoint"></a>create mountpoint</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /mnt/LVM-RECOVED-DISK1</span><br></pre></td></tr></table></figure><h3 id="mount-LVM-DISK-VG"><a href="#mount-LVM-DISK-VG" class="headerlink" title="mount LVM DISK VG"></a>mount LVM DISK VG</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount <span class="regexp">/dev/</span>NEW_VG01_STORAGE_RAID1<span class="regexp">/LV01_STORAGE_RAID1 /m</span>nt/LVM-RECOVED-DISK1</span><br></pre></td></tr></table></figure><h2 id="recover-your-data"><a href="#recover-your-data" class="headerlink" title="recover your data"></a>recover your data</h2><p>now you are able to force your data intire <em>&#x2F;mnt&#x2F;LVM-RECOVED-DISK1</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mnt/LVM-RECOVED-DISK1</span><br><span class="line"><span class="built_in">ls</span> -la</span><br></pre></td></tr></table></figure><pre class="mermaid" style="background: none">mindmap  root((LVM))    raid 1      2 disks    VG      volume group    LG      logical group    mainboard/cpu      defect    Restore      detache one part of disk      attach to another system      remove missing part of raid disk      reneme VG      load md module      mount    Tools      lvscan      vgdisplay      lvdisplay      vgreduce      pvdisplay      vgrename</pre><p>thanks for reading , i hope i helped you</p><p>–<br>Aysad Kozanoglu</p>]]></content>
      
      
      <categories>
          
          <category> lvm </category>
          
          <category> raid1 </category>
          
          <category> disk </category>
          
          <category> mount </category>
          
          <category> recovery </category>
          
      </categories>
      
      
        <tags>
            
            <tag> lvm </tag>
            
            <tag> recovery </tag>
            
            <tag> disk </tag>
            
            <tag> mount </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
